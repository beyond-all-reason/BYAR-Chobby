app-id: info.beyondallreason.bar
runtime: org.freedesktop.Platform
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
  # TODO: Replace shell script call with game launcher
command: hello.sh
sdk-extensions:
  - org.freedesktop.Sdk.Extension.node14
build-options:
  append_path: "/usr/lib/sdk/node14/bin"
  npm_config_cache: /run/build/spring-launcher-backend/flatpak-node/npm-cache
finish-args:
  - --socket=x11
  - --share=ipc
  - --share=network
  - --env=PATH=/usr/bin:/app/bin:/usr/lib/sdk/node14/bin
modules:
  - name: sqlite3
    buildsystem: autotools
    sources:
      - type: archive
        url: https://www.sqlite.org/2021/sqlite-autoconf-3360000.tar.gz
        sha256: bd90c3eb96bee996206b83be7065c9ce19aef38c3f4fb53073ada0d0b69bbce3
  - name: spring-launcher-backend
    buildsystem: simple
    build-commands:
      - sqlite3
      - npm ci --offline --cache=/run/build/spring-launcher-backend/flatpak-node/npm-cache/
    sources:
      - type: git
        url: https://github.com/gajop/spring-launcher-backend
        commit: 6dccaef21a5b9d1db9ee0a584f02f69773f6f560
      - generated-sources.json
  # TODO: Replace this with the launcher after the rest works
  - name: hello
    buildsystem: simple
    build-commands:
      - pwd && ls -al
      - node -v
      - install -D hello.sh /app/bin/hello.sh
      - install -D hello.js /app/bin/hello.js
      - node hello.js
      - hello.sh
    sources:
      - type: file
        path: hello.js
      - type: file
        path: hello.sh
